# ğŸ  Kamau Rental Management System
### Full-Stack Â· React + FastAPI + PostgreSQL

---

## ğŸ“ Project Structure

```
rental-management/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ main.py                  â† FastAPI app entry
â”‚   â”œâ”€â”€ database.py              â† DB connection
â”‚   â”œâ”€â”€ models.py                â† SQLAlchemy models
â”‚   â”œâ”€â”€ schemas.py               â† Pydantic schemas
â”‚   â”œâ”€â”€ seed.py                  â† Seed DB with houses & admin
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ .env                     â† Your environment variables
â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â”œâ”€â”€ auth.py              â† Login / register
â”‚   â”‚   â”œâ”€â”€ houses.py            â† House CRUD
â”‚   â”‚   â”œâ”€â”€ tenants.py           â† Tenant CRUD
â”‚   â”‚   â””â”€â”€ payments.py          â† Payments + dashboard
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ email_service.py     â† Gmail SMTP email
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ auth.py              â† JWT helpers
â””â”€â”€ frontend/
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ App.jsx              â† Router setup
    â”‚   â”œâ”€â”€ main.jsx             â† React entry
    â”‚   â”œâ”€â”€ index.css            â† Global styles + Tailwind
    â”‚   â”œâ”€â”€ api/index.js         â† All API calls
    â”‚   â”œâ”€â”€ context/
    â”‚   â”‚   â””â”€â”€ AuthContext.jsx  â† Login state
    â”‚   â”œâ”€â”€ components/
    â”‚   â”‚   â”œâ”€â”€ Layout.jsx       â† App shell + sidebar
    â”‚   â”‚   â”œâ”€â”€ Modal.jsx        â† Reusable modal
    â”‚   â”‚   â””â”€â”€ FormField.jsx    â† Input/Select/Textarea
    â”‚   â””â”€â”€ pages/
    â”‚       â”œâ”€â”€ LoginPage.jsx    â† Login screen
    â”‚       â”œâ”€â”€ DashboardPage.jsxâ† Stats + charts
    â”‚       â”œâ”€â”€ HousesPage.jsx   â† House management
    â”‚       â”œâ”€â”€ TenantsPage.jsx  â† Tenant management
    â”‚       â””â”€â”€ PaymentsPage.jsx â† Payment recording
    â”œâ”€â”€ package.json
    â”œâ”€â”€ vite.config.js
    â””â”€â”€ tailwind.config.js
```

---

## âš™ï¸ STEP 1 â€” Check & Install Prerequisites

### Check Node.js (need v18+)
```bash
node --version
npm --version
```
**If not installed:**
```bash
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs

# macOS
brew install node

# Windows â†’ https://nodejs.org (download LTS installer)
```

### Check Python (need 3.10+)
```bash
python3 --version
pip3 --version
```
**If not installed:**
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install python3 python3-pip python3-venv -y

# macOS
brew install python3

# Windows â†’ https://python.org (check "Add to PATH" during install)
```

### Check PostgreSQL
```bash
psql --version
```
**If not installed:**
```bash
# Ubuntu/Debian
sudo apt install postgresql postgresql-contrib -y
sudo systemctl start postgresql
sudo systemctl enable postgresql

# macOS
brew install postgresql@15
brew services start postgresql@15

# Windows â†’ https://www.postgresql.org/download/windows/
```

---

## ğŸ—„ï¸ STEP 2 â€” Set Up Database

```bash
# Open PostgreSQL prompt
sudo -u postgres psql          # Linux
psql postgres                  # macOS / Windows

# Run these SQL commands inside psql:
CREATE USER rental_admin WITH PASSWORD 'StrongPass123!';
CREATE DATABASE rental_db OWNER rental_admin;
GRANT ALL PRIVILEGES ON DATABASE rental_db TO rental_admin;
\q

# Test your connection (should ask for password)
psql -U rental_admin -d rental_db -h localhost
```

---

## ğŸ STEP 3 â€” Backend Setup

```bash
# Navigate to backend folder
cd rental-management/backend

# Create Python virtual environment
python3 -m venv venv

# Activate it
source venv/bin/activate           # Linux / macOS
# OR
venv\Scripts\activate              # Windows

# Install all Python packages
pip install -r requirements.txt

# Verify key packages installed
pip show fastapi sqlalchemy psycopg2-binary
```

### Create your `.env` file:
```bash
cp .env.example .env
nano .env        # or use any text editor
```

Fill in your values:
```env
DATABASE_URL=postgresql://rental_admin:StrongPass123!@localhost:5432/rental_db
SECRET_KEY=generate-a-long-random-string-here-at-least-32-characters
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=480

SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=yourgmail@gmail.com
SMTP_PASSWORD=your-gmail-app-password
EMAIL_FROM_NAME=Kamau Rentals
```

> **Gmail App Password Setup:**
> 1. Go to Google Account â†’ Security
> 2. Enable 2-Factor Authentication
> 3. Go to App Passwords â†’ Create new â†’ Copy the 16-character password
> 4. Paste it as `SMTP_PASSWORD`

### Seed the database with houses + admin:
```bash
python seed.py
# Creates: 11 houses (B1-B6, S1-S5) + admin user
# Default login: username=admin, password=admin123
```

### Start the backend server:
```bash
uvicorn main:app --reload --port 8000

# You should see:
# INFO:     Uvicorn running on http://127.0.0.1:8000
```

### Verify backend is running:
```bash
# In a new terminal
curl http://localhost:8000/
# Should return: {"message":"Kamau Rental Management API","status":"running"}

# View interactive API docs:
# Open browser â†’ http://localhost:8000/docs
```

---

## âš›ï¸ STEP 4 â€” Frontend Setup

```bash
# Navigate to frontend folder
cd rental-management/frontend

# Install Node packages
npm install

# Verify key packages
npm list react react-router-dom recharts

# Start development server
npm run dev
# Opens at: http://localhost:5173
```

---

## ğŸ” STEP 5 â€” First Login

1. Open browser â†’ `http://localhost:5173`
2. You'll see the login page
3. Login with:
   - **Username:** `admin`
   - **Password:** `admin123`
4. âš ï¸ **Change this password immediately** after logging in

To change password via API:
```bash
# Open http://localhost:8000/docs
# Use POST /api/auth/register to create a new admin
# (only works when no admin exists â€” use SQL if needed)
```

---

## ğŸš€ Running Both Servers (Development)

**Terminal 1 â€” Backend:**
```bash
cd rental-management/backend
source venv/bin/activate
uvicorn main:app --reload --port 8000
```

**Terminal 2 â€” Frontend:**
```bash
cd rental-management/frontend
npm run dev
```

**Then open:** `http://localhost:5173`

---

## ğŸ“§ Email Features

The system sends emails automatically:
- **Welcome email** â€” when you add a new tenant (if email provided)
- **Payment receipt** â€” when you record a payment (checkbox in form)
- **Payment reminder** â€” click "Send Reminders" button in Payments page

All emails are sent via Gmail SMTP in the background (non-blocking).

---

## ğŸ—ï¸ Production Deployment

### Backend (Gunicorn)
```bash
pip install gunicorn
gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000
```

### Frontend (Build for Production)
```bash
npm run build
# Creates /dist folder â€” deploy to Netlify, Vercel, or Nginx
```

### Nginx config (optional)
```nginx
server {
    listen 80;
    server_name yourdomain.com;

    location / {
        root /path/to/frontend/dist;
        try_files $uri $uri/ /index.html;
    }

    location /api/ {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## ğŸ› ï¸ Useful Commands Reference

| Task | Command |
|------|---------|
| Start backend | `uvicorn main:app --reload` |
| Start frontend | `npm run dev` |
| Seed database | `python seed.py` |
| View API docs | `http://localhost:8000/docs` |
| Check DB status | `sudo systemctl status postgresql` |
| Restart PostgreSQL | `sudo systemctl restart postgresql` |
| Build frontend | `npm run build` |
| Activate Python venv | `source venv/bin/activate` |
| Install backend deps | `pip install -r requirements.txt` |
| Install frontend deps | `npm install` |

---

## ğŸ  Your 11 Units

After seeding, these houses are created automatically:

| Unit | Type | Default Rent |
|------|------|-------------|
| Bedsitter B1 | Bedsitter | KES 8,000 |
| Bedsitter B2 | Bedsitter | KES 8,000 |
| Bedsitter B3 | Bedsitter | KES 8,000 |
| Bedsitter B4 | Bedsitter | KES 8,000 |
| Bedsitter B5 | Bedsitter | KES 8,500 |
| Bedsitter B6 | Bedsitter | KES 8,000 |
| Single S1 | Single Room | KES 5,500 |
| Single S2 | Single Room | KES 5,500 |
| Single S3 | Single Room | KES 5,500 |
| Single S4 | Single Room | KES 5,500 |
| Single S5 | Single Room | KES 5,500 |

Edit rent amounts from the Houses page after login.

---

## ğŸ”’ Security Notes

- All routes require JWT authentication (except `/api/auth/login`)
- Tenant private notes are only visible when logged in
- JWT tokens expire after 8 hours
- Passwords are hashed with bcrypt
- Use HTTPS in production (Let's Encrypt is free)
- Keep your `.env` file secret â€” never commit it to Git

---

*Kamau Family Rental Management Â· Kisumu, Kenya ğŸ‡°ğŸ‡ª*
